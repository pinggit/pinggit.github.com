## Last changed: 2013-08-12 03:57:44 UTC
replace:
logical-systems {
    r0 {
        interfaces {
            ge-1/2/1 {
                unit 1122 {
                    vlan-id 1122;
                    family inet {
                        address 11.22.0.1/24;
                    }
                }
            }
            ge-1/2/2 {
                unit 133 {
                    vlan-id 133;
                    family inet {
                        address 100.1.33.2/24;
                    }
                    family inet6 {
                        address ::100.1.33.2/120;
                    }
                }
                unit 210 {
                    vlan-id 210;
                    family inet {
                        address 100.0.210.2/24;
                    }
                }
                unit 211 {
                    description Connect-R2-P1;
                    vlan-id 211;
                    family inet {
                        address 100.2.11.2/24;
                    }
                    family inet6 {
                        address ::100.2.11.2/120;
                    }
                }
                unit 212 {
                    description Connect-R2-P2;
                    vlan-id 212;
                    family inet {
                        address 100.2.12.2/24;
                    }
                    family inet6 {
                        address ::100.2.12.2/120;
                    }
                }
                unit 213 {
                    description Connect-R2-P3;
                    vlan-id 213;
                    family inet {
                        address 100.2.13.2/24;
                    }
                    family inet6 {
                        address ::100.2.13.2/120;
                    }
                }
                unit 221 {
                    description Connect-R2-T1;
                    vlan-id 221;
                    family inet {
                        address 100.2.21.2/24;
                    }
                    family inet6 {
                        address ::100.2.21.2/120;
                    }
                }
                unit 222 {
                    description Connect-R2-T2;
                    vlan-id 222;
                    family inet {
                        address 100.2.22.2/24;
                    }
                    family inet6 {
                        address ::100.2.22.2/120;
                    }
                }
                unit 311 {
                    description Connect-R3-P1;
                    vlan-id 311;
                    family inet {
                        address 100.3.11.2/24;
                    }
                    family inet6 {
                        address ::100.3.11.2/120;
                    }
                }
                unit 312 {
                    description Connect-R3-P2;
                    vlan-id 312;
                    family inet {
                        address 100.3.12.2/24;
                    }
                    family inet6 {
                        address ::100.3.12.2/120;
                    }
                }
                unit 321 {
                    description Connect-R3-T1;
                    vlan-id 321;
                    family inet {
                        address 100.3.21.2/24;
                    }
                    family inet6 {
                        address ::100.3.21.2/120;
                    }
                }
                unit 322 {
                    description Connect-R3-T2;
                    vlan-id 322;
                    family inet {
                        address 100.3.22.2/24;
                    }
                    family inet6 {
                        address ::100.3.22.2/120;
                    }
                }
                unit 435 {
                    description Connect-R4-C5;
                    vlan-id 435;
                    family inet6 {
                        address ::100.4.35.2/120;
                        address 5555:5555:5555::1/48;
                    }
                }
                unit 512 {
                    description Connect-R5-P2;
                    vlan-id 512;
                    family inet {
                        address 100.5.12.2/24;
                    }
                    family inet6 {
                        address ::100.5.12.2/120;
                    }
                }
                unit 513 {
                    description Connect-R5-P3;
                    vlan-id 513;
                    family inet {
                        address 100.5.13.2/24;
                    }
                    family inet6 {
                        address ::100.5.13.2/120;
                    }
                }
                unit 611 {
                    vlan-id 611;
                    family inet {
                        address 200.6.11.2/24;
                    }
                }
                unit 642 {
                    vlan-id 642;
                    family inet {
                        address 200.6.42.2/24;
                    }
                }
                unit 643 {
                    vlan-id 643;
                    family inet {
                        address 200.6.43.2/24;
                    }
                }
                unit 684 {
                    vlan-id 684;
                    family inet {
                        address 200.6.84.2/24;
                    }
                }
                unit 685 {
                    vlan-id 685;
                    family inet {
                        address 200.6.85.2/24;
                    }
                }
                unit 734 {
                    description Connect-R7-C4;
                    vlan-id 734;
                    family inet {
                        address 100.7.34.2/24;
                        address 44.44.1.1/16;
                    }
                    family inet6 {
                        address 4444:4444:4444::1/48;
                        address ::100.7.34.2/120;
                    }
                }
                unit 1003 {
                    vlan-id 1003;
                    family inet {
                        address 3.3.3.1/24;
                        address 33.33.1.1/16;
                    }
                    family inet6 {
                        address ::3.3.3.1/120;
                        address 3333:3333:3333::1/48;
                    }
                }
                unit 1013 {
                    vlan-id 1013;
                    family inet {
                        address 33.33.33.33/32;
                    }
                    family inet6 {
                        address ::33.33.33.33/128;
                    }
                }
                unit 1122 {
                    vlan-id 1122;
                    family inet {
                        address 11.22.0.2/24;
                    }
                }
                unit 2001 {
                    vlan-id 2001;
                    family inet {
                        address 211.1.0.1/16;
                        address 211.4.0.1/16;
                    }
                    family inet6 {
                        address 2000:1000::1/32;
                        address 2000:4000::1/32;
                    }
                }
                unit 2002 {
                    vlan-id 2002;
                    family inet {
                        address 211.2.0.1/16;
                        address 211.5.0.1/16;
                        address 211.6.0.1/16;
                    }
                    family inet6 {
                        address 2000:2000::1/32;
                        address 2000:5000::1/32;
                        address 2000:6000::1/32;
                    }
                }
                unit 2003 {
                    vlan-id 2003;
                    family inet {
                        address 211.3.0.1/16;
                        address 211.7.0.1/16;
                    }
                    family inet6 {
                        address 2000:3000::1/32;
                        address 2000:7000::1/32;
                    }
                }
                unit 3001 {
                    vlan-id 3001;
                    family inet {
                        address 222.1.0.1/16;
                        address 222.3.0.1/16;
                    }
                    family inet6 {
                        address 3000:1000::1/32;
                        address 3000:3000::1/32;
                    }
                }
                unit 3002 {
                    vlan-id 3002;
                    family inet {
                        address 222.2.0.1/16;
                        address 222.3.0.1/16;
                    }
                    family inet6 {
                        address 3000:2000::1/32;
                        address 3000:4000::1/32;
                    }
                }
            }
            lo0 {
                unit 11 {
                    family inet {
                        address 20.20.1.11/32;
                    }
                }
                unit 12 {
                    family inet {
                        address 20.20.1.22/32;
                    }
                }
                unit 13 {
                    family inet {
                        address 20.20.1.33/32;
                    }
                }
                unit 14 {
                    family inet {
                        address 20.20.1.44/32;
                    }
                }
                unit 15 {
                    family inet {
                        address 20.20.1.55/32;
                    }
                }
            }
        }
        policy-options {
            policy-statement c3-adv-v4 {
                term 1 {
                    from {
                        route-filter 33.33.0.0/16 exact;
                        route-filter 3.3.3.0/24 exact;
                        route-filter 33.33.33.33/32 exact;
                    }
                    then {
                        community add rtbh;
                        accept;
                    }
                }
            }
            policy-statement c3-adv-v6 {
                term 1 {
                    from {
                        route-filter 3333:3333:3333::0/48 exact;
                        route-filter ::3.3.3.0/120 exact;
                        route-filter ::33.33.33.33/128 exact;
                    }
                    then {
                        community add rtbh;
                        accept;
                    }
                }
            }
            policy-statement c4-adv-v4 {
                term 1 {
                    from {
                        route-filter 44.44.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement c4-adv-v6 {
                term 1 {
                    from {
                        route-filter 4444:4444:4444::/48 exact;
                    }
                    then accept;
                }
            }
            policy-statement c5-adv-v6 {
                term 1 {
                    from {
                        route-filter 5555:5555:5555::/48 exact;
                    }
                    then accept;
                }
            }
            policy-statement ce1-adv-ospf {
                term 1 {
                    from {
                        route-filter 20.20.1.11/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement ce3-adv-bgp {
                term 1 {
                    from {
                        protocol direct;
                        route-filter 20.20.1.33/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement ce4-adv-bgp {
                term 1 {
                    from {
                        route-filter 20.20.1.44/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement ce5-adv-bgp {
                term 1 {
                    from {
                        route-filter 20.20.1.55/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement export-to-ospf {
                term static-to-ospf {
                    from protocol static;
                    then accept;
                }
            }
            policy-statement p1-adv-v4-to-r2 {
                term 1 {
                    from {
                        route-filter 211.1.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement p1-adv-v4-to-r3 {
                term 1 {
                    from {
                        route-filter 211.4.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement p1-adv-v6-to-r2 {
                term 1 {
                    from {
                        route-filter 2000:1000::/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement p1-adv-v6-to-r3 {
                term 1 {
                    from {
                        route-filter 2000:4000::/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement p2-adv-v4-to-r2 {
                term 1 {
                    from {
                        route-filter 211.2.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement p2-adv-v4-to-r3 {
                term 1 {
                    from {
                        route-filter 211.5.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement p2-adv-v4-to-r5 {
                term 1 {
                    from {
                        route-filter 211.6.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement p2-adv-v6-to-r2 {
                term 1 {
                    from {
                        route-filter 2000:2000::/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement p2-adv-v6-to-r3 {
                term 1 {
                    from {
                        route-filter 2000:5000::/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement p2-adv-v6-to-r5 {
                term 1 {
                    from {
                        route-filter 2000:6000::/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement p3-adv-v4-to-r2 {
                term 1 {
                    from {
                        route-filter 211.3.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement p3-adv-v4-to-r5 {
                term 1 {
                    from {
                        route-filter 211.7.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement p3-adv-v6-to-r2 {
                term 1 {
                    from {
                        route-filter 2000:3000::/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement p3-adv-v6-to-r5 {
                term 1 {
                    from {
                        route-filter 2000:7000::/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement t1-adv-v4-to-r2 {
                term 1 {
                    from {
                        route-filter 222.1.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement t1-adv-v4-to-r3 {
                term 1 {
                    from {
                        route-filter 222.3.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement t1-adv-v6-to-r2 {
                term 1 {
                    from {
                        route-filter 3000:1000::/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement t1-adv-v6-to-r3 {
                term 1 {
                    from {
                        route-filter 3000:3000::/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement t2-adv-v4-to-r2 {
                term 1 {
                    from {
                        route-filter 222.2.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement t2-adv-v4-to-r3 {
                term 1 {
                    from {
                        route-filter 222.4.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement t2-adv-v6-to-r2 {
                term 1 {
                    from {
                        route-filter 3000:2000::/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement t2-adv-v6-to-r3 {
                term 1 {
                    from {
                        route-filter 3000:4000::/32 exact;
                    }
                    then accept;
                }
            }
            community rtbh members [ 65412:100 target:4012345678L:2000 ];
        }
        routing-instances {
            c3 {
                instance-type virtual-router;
                interface ge-1/2/2.133;
                interface ge-1/2/2.1003;
                interface ge-1/2/2.1013;
                routing-options {
                    autonomous-system 300;
                }
                protocols {
                    bgp {
                        export [ c3-adv-v4 c3-adv-v6 ];
                        group to-r1 {
                            type external;
                            family inet {
                                unicast;
                            }
                            family inet6 {
                                unicast;
                            }
                            peer-as 65513;
                            neighbor 100.1.33.1;
                        }
                    }
                }
            }
            c4 {
                instance-type virtual-router;
                interface ge-1/2/2.734;
                routing-options {
                    autonomous-system 400;
                }
                protocols {
                    bgp {
                        export [ c4-adv-v4 c4-adv-v6 ];
                        group to-r7-v4 {
                            type external;
                            accept-remote-nexthop;
                            family inet {
                                unicast;
                            }
                            family inet6 {
                                unicast;
                            }
                            neighbor 100.7.34.1 {
                                peer-as 4012345678;
                            }
                        }
                    }
                }
            }
            c5 {
                instance-type virtual-router;
                interface ge-1/2/2.435;
                routing-options {
                    router-id 55.55.55.55;
                    autonomous-system 500;
                }
                protocols {
                    bgp {
                        group to-r4-v6 {
                            type external;
                            family inet6 {
                                unicast;
                            }
                            export c5-adv-v6;
                            neighbor ::100.4.35.1 {
                                local-address ::100.4.35.2;
                                peer-as 4012345678;
                            }
                        }
                    }
                }
            }
            dc {
                instance-type virtual-router;
                interface ge-1/2/2.210;
                routing-options {
                    static {
                        route 172.16.1.0/24 reject;
                        route 172.16.2.0/24 reject;
                        route 172.16.3.0/24 reject;
                        route 172.16.4.0/24 reject;
                        route 172.16.5.0/24 reject;
                        route 172.16.6.0/24 reject;
                        route 172.16.7.0/24 reject;
                        route 172.16.8.0/24 reject;
                        route 172.16.9.0/24 reject;
                        route 172.16.10.0/24 reject;
                        route 172.16.11.0/24 reject;
                        route 172.16.12.0/24 reject;
                        route 172.16.13.0/24 reject;
                        route 172.16.14.0/24 reject;
                        route 172.16.15.0/24 reject;
                        route 172.16.16.0/24 reject;
                        route 172.16.17.0/24 reject;
                        route 172.16.18.0/24 reject;
                        route 172.16.19.0/24 reject;
                    }
                }
                protocols {
                    ospf {
                        export export-to-ospf;
                        area 0.0.0.0 {
                            interface ge-1/2/2.210 {
                                bfd-liveness-detection {
                                    minimum-interval 100;
                                    multiplier 3;
                                }
                            }
                        }
                    }
                }
            }
            p1 {
                instance-type virtual-router;
                interface ge-1/2/2.211;
                interface ge-1/2/2.311;
                interface ge-1/2/2.2001;
                routing-options {
                    autonomous-system 1000;
                }
                protocols {
                    bgp {
                        group to-r2-v4 {
                            type external;
                            export p1-adv-v4-to-r2;
                            neighbor 100.2.11.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r3-v4 {
                            type external;
                            export p1-adv-v4-to-r3;
                            neighbor 100.3.11.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r2-v6 {
                            type external;
                            family inet6 {
                                unicast;
                            }
                            export p1-adv-v6-to-r2;
                            neighbor ::100.2.11.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r3-v6 {
                            type external;
                            family inet6 {
                                unicast;
                            }
                            export p1-adv-v6-to-r3;
                            neighbor ::100.3.11.1 {
                                peer-as 4012345678;
                            }
                        }
                    }
                }
            }
            p2 {
                instance-type virtual-router;
                interface ge-1/2/2.212;
                interface ge-1/2/2.312;
                interface ge-1/2/2.512;
                interface ge-1/2/2.2002;
                routing-options {
                    autonomous-system 2000;
                }
                protocols {
                    bgp {
                        group to-r2-v4 {
                            type external;
                            export p2-adv-v4-to-r2;
                            neighbor 100.2.12.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r3-v4 {
                            type external;
                            export p2-adv-v4-to-r3;
                            neighbor 100.3.12.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r5-v4 {
                            type external;
                            export p2-adv-v4-to-r5;
                            neighbor 100.5.12.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r2-v6 {
                            type external;
                            family inet6 {
                                unicast;
                            }
                            export p2-adv-v6-to-r2;
                            neighbor ::100.2.12.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r3-v6 {
                            type external;
                            family inet6 {
                                unicast;
                            }
                            export p2-adv-v6-to-r3;
                            neighbor ::100.3.12.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r5-v6 {
                            export p2-adv-v6-to-r5;
                            neighbor ::100.5.12.1 {
                                peer-as 4012345678;
                            }
                        }
                    }
                }
            }
            p3 {
                instance-type virtual-router;
                interface ge-1/2/2.213;
                interface ge-1/2/2.513;
                interface ge-1/2/2.2003;
                routing-options {
                    autonomous-system 3000;
                }
                protocols {
                    bgp {
                        group to-r2-v4 {
                            export p3-adv-v4-to-r2;
                            neighbor 100.2.13.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r5-v4 {
                            type external;
                            export p3-adv-v4-to-r5;
                            neighbor 100.5.13.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r2-v6 {
                            type external;
                            family inet6 {
                                unicast;
                            }
                            export p3-adv-v6-to-r2;
                            neighbor ::100.2.13.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r5-v6 {
                            type external;
                            family inet6 {
                                unicast;
                            }
                            export p3-adv-v6-to-r5;
                            neighbor ::100.5.13.1 {
                                peer-as 4012345678;
                            }
                        }
                    }
                }
            }
            t1 {
                instance-type virtual-router;
                interface ge-1/2/2.221;
                interface ge-1/2/2.321;
                interface ge-1/2/2.3001;
                routing-options {
                    autonomous-system 1100;
                }
                protocols {
                    bgp {
                        group to-r2-v4 {
                            type external;
                            export t1-adv-v4-to-r2;
                            neighbor 100.2.21.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r3-v4 {
                            type external;
                            export t1-adv-v4-to-r3;
                            neighbor 100.3.21.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r2-v6 {
                            type external;
                            family inet6 {
                                unicast;
                            }
                            export t1-adv-v6-to-r2;
                            neighbor ::100.2.21.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r3-v6 {
                            type external;
                            family inet6 {
                                unicast;
                            }
                            export t1-adv-v6-to-r3;
                            neighbor ::100.3.21.1 {
                                peer-as 4012345678;
                            }
                        }
                    }
                }
            }
            t2 {
                instance-type virtual-router;
                interface ge-1/2/2.222;
                interface ge-1/2/2.322;
                interface ge-1/2/2.3002;
                routing-options {
                    autonomous-system 1200;
                }
                protocols {
                    bgp {
                        group to-r2-v4 {
                            type external;
                            export t2-adv-v4-to-r2;
                            neighbor 100.2.22.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r3-v4 {
                            type external;
                            export t2-adv-v4-to-r3;
                            neighbor 100.3.22.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r2-v6 {
                            type external;
                            family inet6 {
                                unicast;
                            }
                            export t2-adv-v6-to-r2;
                            neighbor ::100.2.22.1 {
                                peer-as 4012345678;
                            }
                        }
                        group to-r3-v6 {
                            type external;
                            family inet6 {
                                unicast;
                            }
                            export t2-adv-v6-to-r3;
                            neighbor ::100.3.22.1 {
                                peer-as 4012345678;
                            }
                        }
                    }
                }
            }
            vpn1 {
                instance-type virtual-router;
                interface ge-1/2/1.1122;
                interface ge-1/2/2.611;
                interface lo0.11;
                protocols {
                    ospf {
                        export ce1-adv-ospf;
                        area 0.0.0.0 {
                            interface ge-1/2/2.611;
                            interface ge-1/2/1.1122 {
                                metric 50;
                            }
                        }
                    }
                }
            }
            vpn2 {
                instance-type virtual-router;
                interface ge-1/2/2.642;
                interface ge-1/2/2.1122;
                interface lo0.12;
                protocols {
                    ospf {
                        area 0.0.0.0 {
                            interface lo0.12;
                            interface ge-1/2/2.642;
                            interface ge-1/2/2.1122 {
                                metric 50;
                            }
                        }
                    }
                }
            }
            vpn3 {
                instance-type virtual-router;
                interface ge-1/2/2.643;
                interface lo0.13;
                routing-options {
                    autonomous-system 65000;
                }
                protocols {
                    bgp {
                        group to-r4 {
                            type external;
                            family inet {
                                unicast;
                            }
                            export ce3-adv-bgp;
                            neighbor 200.6.43.1 {
                                peer-as 4012345678;
                            }
                        }
                    }
                }
            }
            vpn4 {
                instance-type virtual-router;
                interface ge-1/2/2.684;
                interface lo0.14;
                routing-options {
                    autonomous-system 65000;
                }
                protocols {
                    bgp {
                        group to-r8 {
                            type external;
                            family inet {
                                unicast;
                            }
                            export ce4-adv-bgp;
                            peer-as 4012345678;
                            neighbor 200.6.84.1;
                        }
                    }
                }
            }
            vpn5 {
                instance-type virtual-router;
                interface ge-1/2/2.685;
                interface lo0.15;
                routing-options {
                    autonomous-system 65000;
                }
                protocols {
                    bgp {
                        group to-r8 {
                            type external;
                            family inet {
                                unicast;
                            }
                            export ce5-adv-bgp;
                            peer-as 4012345678;
                            neighbor 200.6.85.1;
                        }
                    }
                }
            }
        }
    }
    r1 {
        apply-groups interface;
        interfaces {
            ge-1/2/1 {
                unit 102 {
                    apply-groups-except interface;
                    vlan-id 102;
                    family inet {
                        address 100.0.12.1/24;
                    }
                    family iso;
                    family inet6;
                    family mpls;
                }
                unit 103 {
                    apply-groups-except interface;
                    vlan-id 103;
                    family inet {
                        address 100.0.13.1/24;
                    }
                    family iso;
                    family inet6;
                    family mpls;
                }
                unit 133 {
                    description To-C1;
                    vlan-id 133;
                    family inet {
                        filter {
                            input J-Classifier;
                        }
                        address 100.1.33.1/24;
                    }
                    family inet6 {
                        address ::100.1.33.1/120;
                    }
                }
                unit 611 {
                    vlan-id 611;
                    family inet {
                        address 200.6.11.1/24;
                    }
                }
            }
            lo0 {
                unit 1 {
                    family inet {
                        address 10.200.1.1/32;
                    }
                    family iso {
                        address 49.0001.0102.0000.1001.00;
                    }
                    family inet6 {
                        address 2011:0310:1020::1/128;
                    }
                }
                unit 111 {
                    apply-groups-except interface;
                    family inet {
                        address 1.1.1.1/32;
                    }
                }
            }
        }
        protocols {
            rsvp {
                interface ge-1/2/1.102;
                interface ge-1/2/1.103;
            }
            mpls {
                ipv6-tunneling;
                icmp-tunneling;
                label-switched-path r1-r2 {
                    to 10.200.1.2;
                }
                label-switched-path r1-r3 {
                    to 10.200.1.3;
                }
                label-switched-path r1-r4 {
                    to 10.200.1.4;
                }
                label-switched-path r1-r5 {
                    to 10.200.1.5;
                    ldp-tunneling;
                }
                label-switched-path r1-r6 {
                    to 10.200.1.6;
                    ldp-tunneling;
                    priority 7 7;
                }
                label-switched-path r1-r4-green {
                    to 10.200.1.4;
                }
                label-switched-path r1-r4-blue {
                    to 10.200.1.4;
                }
                interface ge-1/2/1.102;
                interface ge-1/2/1.103;
            }
            bgp {
                group to-v4v6-rr {
                    type internal;
                    local-address 10.200.1.1;
                    family inet {
                        unicast;
                        labeled-unicast {
                            rib {
                                inet.3;
                            }
                        }
                    }
                    family inet6 {
                        labeled-unicast {
                            explicit-null;
                        }
                    }
                    export [ exp-bgp-nhs exp-bgp-lo0-v6 exp-bgp-vpn-agg ];
                    neighbor 10.200.1.5;
                    neighbor 10.200.1.6;
                }
                group to-vpn-rr {
                    type internal;
                    local-address 10.200.1.1;
                    family inet-vpn {
                        unicast;
                    }
                    neighbor 10.200.1.2;
                    neighbor 10.200.1.3;
                }
                group to-c3 {
                    type external;
                    accept-remote-nexthop;
                    import [ imp-bgp-tag-c imp-bgp-fix-nh ];
                    family inet {
                        unicast;
                    }
                    family inet6 {
                        unicast;
                    }
                    export [ exp-bgp-fix-nh exp-bgp-vpn-agg ];
                    neighbor 100.1.33.2 {
                        peer-as 300;
                        local-as 65513 private;
                    }
                }
            }
            isis {
                reference-bandwidth 5g;
                no-ipv6-routing;
                level 1 disable;
                level 2 {
                    authentication-key "$9$/9n-Au1Srv7-wRh-wYgUD9Ap"; ## SECRET-DATA
                    authentication-type md5;
                }
                interface ge-1/2/1.102;
                interface ge-1/2/1.103;
                interface lo0.1;
            }
            ldp {
                interface lo0.1;
            }
        }
        policy-options {
            policy-statement exp-bgp-fix-nh {
                term 1 {
                    from {
                        protocol bgp;
                        route-filter ::/0 prefix-length-range /0-/128;
                    }
                    then {
                        next-hop ::100.1.33.1;
                    }
                }
            }
            policy-statement exp-bgp-lo0-v6 {
                term 1 {
                    from {
                        route-filter 2011:0310:1020::1/128 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-nhs {
                term 1 {
                    from {
                        protocol bgp;
                        route-type external;
                    }
                    then {
                        next-hop self;
                    }
                }
            }
            policy-statement exp-bgp-vpn-agg {
                term 1 {
                    from {
                        protocol aggregate;
                        route-filter 20.20.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-defaults-to-vpn1 {
                term 1 {
                    from {
                        protocol static;
                        route-filter 0.0.0.0/0 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-fwd-fix-vpn-agg-nh {
                term 1 {
                    from {
                        protocol aggregate;
                        rib inet.0;
                        route-filter 20.20.0.0/16 exact;
                    }
                    then {
                        next-hop next-table GREEN.inet.0;
                        accept;
                    }
                }
            }
            policy-statement exp-fwd-lsp-map {
                term 1 {
                    from {
                        protocol bgp;
                        community ce2;
                    }
                    then {
                        install-nexthop lsp r1-r4-green;
                    }
                }
                term 2 {
                    from {
                        protocol bgp;
                        community ce3;
                    }
                    then {
                        install-nexthop lsp r1-r4-blue;
                    }
                }
            }
            policy-statement imp-bgp-fix-nh {
                term 1 {
                    from {
                        protocol bgp;
                        route-filter ::0/0 prefix-length-range /0-/128;
                    }
                    then {
                        next-hop ::100.1.33.2;
                    }
                }
            }
            policy-statement imp-bgp-tag-c {
                term 1 {
                    from protocol bgp;
                    then {
                        community add c-route;
                    }
                }
            }
            policy-statement vrf-exp {
                term 1 {
                    from protocol ospf;
                    then {
                        community add GREEN;
                        accept;
                    }
                }
                term 2 {
                    from protocol direct;
                    then {
                        community add GREEN;
                        accept;
                    }
                }
                term 3 {
                    from {
                        protocol static;
                        route-filter 0.0.0.0/0 exact;
                    }
                    then {
                        community add GREEN;
                        accept;
                    }
                }
            }
            policy-statement vrf-exp-bgp-ospf {
                term 1 {
                    from {
                        protocol bgp;
                        community GREEN;
                    }
                    then accept;
                }
            }
            policy-statement vrf-imp {
                term 1 {
                    from {
                        protocol bgp;
                        community GREEN;
                    }
                    then accept;
                }
            }
            community GREEN members target:2:65000;
            community c-route members 65513:100;
            community ce2 members target:65000:2;
            community ce3 members target:65000:3;
            community p-route members 65513:200;
            community t-route members 65513:300;
        }
        routing-instances {
            GREEN {
                instance-type vrf;
                interface ge-1/2/1.611;
                interface lo0.111;
                route-distinguisher 10.200.1.1:1;
                vrf-import vrf-imp;
                vrf-export vrf-exp;
                vrf-table-label;
                routing-options {
                    static {
                        route 0.0.0.0/0 next-table inet.0;
                    }
                }
                protocols {
                    ospf {
                        rib-group imp-vrf-to-inet.0;
                        export [ vrf-exp-bgp-ospf exp-defaults-to-vpn1 ];
                        sham-link local 1.1.1.1;
                        area 0.0.0.0 {
                            sham-link-remote 4.4.4.4;
                            interface ge-1/2/1.611;
                        }
                    }
                }
            }
        }
        routing-options {
            graceful-restart;
            aggregate {
                route 20.20.0.0/16;
            }
            rib-groups {
                imp-vrf-to-inet.0 {
                    import-rib [ GREEN.inet.0 inet.0 ];
                }
            }
            autonomous-system 4012345678;
            forwarding-table {
                export [ exp-fwd-fix-vpn-agg-nh exp-fwd-lsp-map ];
            }
        }
        firewall {
            policer 5m {
                if-exceeding {
                    bandwidth-limit 5m;
                    burst-size-limit 15k;
                }
                then discard;
            }
            policer 7m {
                if-exceeding {
                    bandwidth-limit 7m;
                    burst-size-limit 15k;
                }
                then discard;
            }
            policer 10m {
                if-exceeding {
                    bandwidth-limit 10m;
                    burst-size-limit 15k;
                }
                then discard;
            }
            filter J-Classifier {
                term 1 {
                    from {
                        precedence 7;
                    }
                    then {
                        policer 5m;
                        forwarding-class expedited-forwarding;
                        accept;
                    }
                }
                term 2 {
                    from {
                        precedence 6;
                    }
                    then {
                        policer 10m;
                        forwarding-class assured-forwarding;
                        accept;
                    }
                }
                term 3 {
                    then {
                        policer 7m;
                        forwarding-class best-effort;
                        accept;
                    }
                }
            }
        }
    }
    r2 {
        apply-groups interface;
        interfaces {
            ge-1/2/1 {
                unit 203 {
                    vlan-id 203;
                    family inet {
                        address 100.0.23.1/24;
                    }
                }
                unit 204 {
                    vlan-id 204;
                    family inet {
                        address 100.0.24.1/24;
                    }
                }
                unit 205 {
                    vlan-id 205;
                    family inet {
                        address 100.0.25.1/24;
                    }
                }
                unit 206 {
                    vlan-id 206;
                    family inet {
                        address 100.0.26.1/24;
                    }
                }
                unit 210 {
                    vlan-id 210;
                    family inet {
                        filter {
                            input filter-block-ipv4;
                        }
                        address 100.0.210.1/24;
                    }
                    family inet6 {
                        filter {
                            input filter-block-ipv6;
                        }
                    }
                }
                unit 211 {
                    description Connect-R2-P1;
                    vlan-id 211;
                    family inet {
                        address 100.2.11.1/24;
                    }
                    family inet6 {
                        address ::100.2.11.1/120;
                    }
                }
                unit 212 {
                    description Connect-R2-P2;
                    vlan-id 212;
                    family inet {
                        address 100.2.12.1/24;
                    }
                    family inet6 {
                        address ::100.2.12.1/120;
                    }
                }
                unit 213 {
                    description Connect-R2-P3;
                    vlan-id 213;
                    family inet {
                        address 100.2.13.1/24;
                    }
                    family inet6 {
                        address ::100.2.13.1/120;
                    }
                }
                unit 221 {
                    description Connect-R2-T1;
                    vlan-id 221;
                    family inet {
                        address 100.2.21.1/24;
                    }
                    family inet6 {
                        address ::100.2.21.1/120;
                    }
                }
                unit 222 {
                    description Connect-R2-T2;
                    vlan-id 222;
                    family inet {
                        address 100.2.22.1/24;
                    }
                    family inet6 {
                        address ::100.2.22.1/120;
                    }
                }
            }
            ge-1/2/2 {
                unit 102 {
                    vlan-id 102;
                    family inet {
                        address 100.0.12.2/24;
                    }
                }
            }
            lo0 {
                unit 2 {
                    family inet {
                        address 10.200.1.2/32;
                    }
                    family iso {
                        address 49.0001.0102.0000.1002.00;
                    }
                    family inet6 {
                        address 2011:0310:1020::2/128;
                    }
                }
            }
        }
        protocols {
            rsvp {
                interface ge-1/2/2.102;
                interface ge-1/2/1.203;
                interface ge-1/2/1.204;
                interface ge-1/2/1.205;
                interface ge-1/2/1.206 {
                    link-protection;
                }
            }
            mpls {
                explicit-null;
                ipv6-tunneling;
                icmp-tunneling;
                label-switched-path r2-r1 {
                    to 10.200.1.1;
                }
                label-switched-path r2-r3 {
                    to 10.200.1.3;
                }
                label-switched-path r2-r4 {
                    to 10.200.1.4;
                }
                label-switched-path r2-r5 {
                    to 10.200.1.5;
                    primary via-r4-r6;
                }
                label-switched-path r2-r6 {
                    to 10.200.1.6;
                    link-protection;
                }
                path via-r4-r6 {
                    10.200.1.4 loose;
                    10.200.1.6 loose;
                }
                interface ge-1/2/2.102;
                interface ge-1/2/1.203;
                interface ge-1/2/1.204;
                interface ge-1/2/1.205;
                interface ge-1/2/1.206;
            }
            bgp {
                group to-v4v6-rr {
                    type internal;
                    local-address 10.200.1.2;
                    import imp-bgp-rtbh;
                    family inet {
                        unicast;
                        labeled-unicast {
                            rib-group copy-inet.3-to-inet6.3;
                            rib {
                                inet.3;
                            }
                        }
                    }
                    family inet6 {
                        labeled-unicast {
                            explicit-null;
                        }
                    }
                    export [ exp-bgp-nhs exp-bgp-lo0-v6 ];
                    neighbor 10.200.1.5;
                    neighbor 10.200.1.6;
                }
                group vpn-rr {
                    type internal;
                    local-address 10.200.1.2;
                    family inet-vpn {
                        unicast;
                    }
                    cluster 2.2.2.2;
                    neighbor 10.200.1.1;
                    neighbor 10.200.1.7;
                    neighbor 10.200.1.8;
                    neighbor 10.200.1.4;
                }
                group to-r3 {
                    type internal;
                    local-address 10.200.1.2;
                    family l2vpn {
                        signaling;
                    }
                    neighbor 10.200.1.3;
                }
                group to-p-v4 {
                    type external;
                    import imp-bgp-p-tag;
                    family inet {
                        unicast;
                    }
                    export exp-bgp-p-out;
                    neighbor 100.2.11.2 {
                        peer-as 1000;
                    }
                    neighbor 100.2.12.2 {
                        peer-as 2000;
                    }
                    neighbor 100.2.13.2 {
                        peer-as 3000;
                    }
                }
                group to-t-v4 {
                    type external;
                    import imp-bgp-t-route;
                    family inet {
                        unicast;
                    }
                    export exp-bgp-t-out;
                    neighbor 100.2.22.2 {
                        peer-as 1200;
                    }
                    neighbor 100.2.21.2 {
                        peer-as 1100;
                    }
                }
                group to-p-v6 {
                    type external;
                    import imp-bgp-p-tag;
                    family inet6 {
                        unicast;
                    }
                    export exp-bgp-p-out;
                    neighbor ::100.2.11.2 {
                        peer-as 1000;
                    }
                    neighbor ::100.2.12.2 {
                        peer-as 2000;
                    }
                    neighbor ::100.2.13.2 {
                        peer-as 3000;
                    }
                }
                group to-t-v6 {
                    type external;
                    import imp-bgp-t-route;
                    family inet6 {
                        unicast;
                    }
                    export exp-bgp-t-out;
                    neighbor ::100.2.21.2 {
                        peer-as 1100;
                    }
                    neighbor ::100.2.22.2 {
                        peer-as 1200;
                    }
                }
            }
            isis {
                export exp-isis-from-ospf;
                reference-bandwidth 5g;
                no-ipv6-routing;
                level 1 disable;
                level 2 {
                    authentication-key "$9$GVjkPFnCBIc5QIcylLXUjH"; ## SECRET-DATA
                    authentication-type md5;
                }
                interface ge-1/2/1.203;
                interface ge-1/2/1.204;
                interface ge-1/2/1.205;
                interface ge-1/2/1.206;
                interface ge-1/2/2.102;
                interface lo0.2;
            }
            ospf {
                export exp-ospf-from-isis;
                import imp-ospf-rej-longer;
                area 0.0.0.0 {
                    interface ge-1/2/1.210 {
                        bfd-liveness-detection {
                            minimum-interval 300;
                        }
                    }
                }
            }
        }
        policy-options {
            policy-statement exp-bgp-lo0-v6 {
                term 1 {
                    from {
                        route-filter 2011:0310:1020::2/128 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-nhs {
                term 1 {
                    from {
                        protocol bgp;
                        route-type external;
                    }
                    then {
                        next-hop self;
                    }
                }
            }
            policy-statement exp-bgp-p-out {
                term 1 {
                    from {
                        protocol bgp;
                        community t-route;
                    }
                    then reject;
                }
                term 2 {
                    from {
                        route-filter 0.0.0.0/0 prefix-length-range /21-/32;
                    }
                    then reject;
                }
                term 3 {
                    from {
                        route-filter ::/0 prefix-length-range /49-/128;
                    }
                    then reject;
                }
                term 4 {
                    from {
                        route-filter 10.200.0.0/16 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-t-out {
                term 1 {
                    from {
                        protocol bgp;
                        community p-route;
                    }
                    then reject;
                }
                term 2 {
                    then accept;
                }
            }
            policy-statement exp-isis-from-ospf {
                term 1 {
                    from {
                        protocol aggregate;
                        route-filter 172.16.8.0/21 exact;
                        route-filter 172.16.16.0/22 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-ospf-from-isis {
                term 1 {
                    from {
                        protocol aggregate;
                        route-filter 10.200.0.0/16 exact;
                    }
                    then accept;
                }
                term 2 {
                    from {
                        protocol aggregate;
                        route-filter 0.0.0.0/0 exact;
                    }
                    then accept;
                }
            }
            policy-statement imp-bgp-p-tag {
                term 1 {
                    from protocol bgp;
                    then {
                        community add p-route;
                    }
                }
            }
            policy-statement imp-bgp-rtbh {
                term 1 {
                    from {
                        protocol bgp;
                        community rtbh;
                        route-filter 0.0.0.0/0 prefix-length-range /32-/32;
                    }
                    then {
                        next-hop discard;
                        accept;
                    }
                }
                term 2 {
                    from {
                        protocol bgp;
                        community rtbh;
                        route-filter ::/0 prefix-length-range /128-/128;
                    }
                    then {
                        next-hop discard;
                        accept;
                    }
                }
                term 3 {
                    from {
                        protocol bgp;
                        community rtbh;
                    }
                    then {
                        community delete rtbh;
                        accept;
                    }
                }
            }
            policy-statement imp-bgp-t-route {
                term 1 {
                    from protocol bgp;
                    then {
                        community add t-route;
                    }
                }
            }
            policy-statement imp-ospf-rej-longer {
                term 1 {
                    from {
                        protocol ospf;
                        route-filter 172.16.0.0/21 orlonger;
                    }
                    then reject;
                }
                term 2 {
                    then accept;
                }
            }
            policy-statement only-if-from-bgp {
                term 1 {
                    from {
                        protocol bgp;
                        route-filter 0.0.0.0/0 prefix-length-range /0-/32;
                    }
                    then accept;
                }
                term 2 {
                    then reject;
                }
            }
            community c-route members 65513:100;
            community p-route members 65513:200;
            community rtbh members [ 65412:100 target:4012345678L:2000 ];
            community t-route members 65513:300;
        }
        routing-options {
            graceful-restart;
            aggregate {
                route 172.16.8.0/21;
                route 172.16.16.0/22;
                route 10.200.0.0/16;
            }
            generate {
                route 0.0.0.0/0 policy only-if-from-bgp;
            }
            rib-groups {
                copy-inet.3-to-inet6.3 {
                    import-rib [ inet.3 inet6.3 ];
                }
            }
            autonomous-system 4012345678;
        }
        firewall {
            family inet {
                filter filter-block-ipv4 {
                    term 1 {
                        from {
                            destination-address {
                                192.168.100.0/24;
                            }
                        }
                        then {
                            log;
                            discard;
                        }
                    }
                    term 2 {
                        then accept;
                    }
                }
            }
            family inet6 {
                filter filter-block-ipv6 {
                    term 1 {
                        from {
                            destination-address {
                                8000::/16;
                            }
                        }
                        then {
                            log;
                            discard;
                        }
                    }
                    term 2 {
                        then accept;
                    }
                }
            }
        }
    }
    r3 {
        apply-groups interface;
        interfaces {
            ge-1/2/1 {
                unit 305 {
                    vlan-id 305;
                    family inet {
                        address 100.0.35.1/24;
                    }
                }
                inactive: unit 306 {
                    vlan-id 306;
                    family inet {
                        address 100.0.36.1/24;
                    }
                }
                unit 311 {
                    description Connect-R3-P1;
                    vlan-id 311;
                    family inet {
                        address 100.3.11.1/24;
                    }
                    family inet6 {
                        address ::100.3.11.1/120;
                    }
                }
                unit 312 {
                    description Connect-R3-P2;
                    vlan-id 312;
                    family inet {
                        address 100.3.12.1/24;
                    }
                    family inet6 {
                        address ::100.3.12.1/120;
                    }
                }
                unit 321 {
                    description Connect-R3-T1;
                    vlan-id 321;
                    family inet {
                        address 100.3.21.1/24;
                    }
                    family inet6 {
                        address ::100.3.21.1/120;
                    }
                }
                unit 322 {
                    description Connect-R3-T2;
                    vlan-id 322;
                    family inet {
                        address 100.3.22.1/24;
                    }
                    family inet6 {
                        address ::100.3.22.1/120;
                    }
                }
            }
            ge-1/2/2 {
                unit 103 {
                    vlan-id 103;
                    family inet {
                        address 100.0.13.2/24;
                    }
                }
                unit 203 {
                    vlan-id 203;
                    family inet {
                        address 100.0.23.2/24;
                    }
                }
            }
            ae10 {
                unit 0 {
                    family inet {
                        address 10.100.36.1/24;
                    }
                    family iso;
                }
            }
            lo0 {
                unit 3 {
                    family inet {
                        address 10.200.1.3/32;
                    }
                    family iso {
                        address 49.0001.0102.0000.1003.00;
                    }
                    family inet6 {
                        address 2011:0310:1020::3/128;
                    }
                }
            }
        }
        protocols {
            rsvp {
                interface ge-1/2/2.103;
                interface ge-1/2/2.203;
                interface ge-1/2/1.305;
                interface ge-1/2/1.306;
            }
            mpls {
                admin-groups {
                    blue 4;
                }
                ipv6-tunneling;
                icmp-tunneling;
                label-switched-path r3-r1 {
                    to 10.200.1.1;
                }
                label-switched-path r3-r2 {
                    to 10.200.1.2;
                }
                label-switched-path r3-r4 {
                    to 10.200.1.4;
                }
                label-switched-path r3-r5 {
                    to 10.200.1.5;
                    admin-group exclude blue;
                }
                label-switched-path r3-r6 {
                    to 10.200.1.6;
                    policing filter lsp-60m;
                }
                interface ge-1/2/2.103;
                interface ge-1/2/2.203;
                interface ge-1/2/1.305 {
                    admin-group blue;
                }
                interface ge-1/2/1.306;
            }
            bgp {
                group to-v4v6-rr {
                    type internal;
                    local-address 10.200.1.3;
                    import imp-bgp-rtbh;
                    family inet {
                        unicast;
                        labeled-unicast {
                            rib-group copy-inet.3-to-inet6.3;
                            rib {
                                inet.3;
                            }
                        }
                    }
                    family inet6 {
                        labeled-unicast {
                            explicit-null;
                        }
                    }
                    export [ exp-bgp-nhs exp-bgp-lo0-v6 ];
                    neighbor 10.200.1.5;
                    neighbor 10.200.1.6;
                }
                group vpn-rr {
                    type internal;
                    local-address 10.200.1.3;
                    family inet-vpn {
                        unicast;
                    }
                    cluster 3.3.3.3;
                    neighbor 10.200.1.1;
                    neighbor 10.200.1.7;
                    neighbor 10.200.1.8;
                    neighbor 10.200.1.4;
                }
                group to-r2 {
                    type internal;
                    local-address 10.200.1.3;
                    family l2vpn {
                        signaling;
                    }
                    neighbor 10.200.1.2;
                }
                group to-p-v4 {
                    type external;
                    import imp-bgp-p-tag;
                    family inet {
                        unicast;
                    }
                    export exp-bgp-p-out;
                    neighbor 100.3.11.2 {
                        peer-as 1000;
                    }
                    neighbor 100.3.12.2 {
                        peer-as 2000;
                    }
                }
                group to-t-v4 {
                    type external;
                    import imp-bgp-t-tag;
                    family inet {
                        unicast;
                    }
                    export exp-bgp-t-out;
                    neighbor 100.3.21.2 {
                        peer-as 1100;
                    }
                    neighbor 100.3.22.2 {
                        peer-as 1200;
                    }
                }
                group to-p-v6 {
                    type external;
                    import imp-bgp-p-tag;
                    family inet6 {
                        unicast;
                    }
                    export exp-bgp-p-out;
                    neighbor ::100.3.11.2 {
                        peer-as 1000;
                    }
                    neighbor ::100.3.12.2 {
                        peer-as 2000;
                    }
                }
                group to-t-v6 {
                    type external;
                    import imp-bgp-t-tag;
                    family inet6 {
                        unicast;
                    }
                    export exp-bgp-t-out;
                    neighbor ::100.3.21.2 {
                        peer-as 1100;
                    }
                    neighbor ::100.3.22.2 {
                        peer-as 1200;
                    }
                }
            }
            isis {
                traceoptions {
                    file ae;
                    flag general;
                }
                reference-bandwidth 5g;
                no-ipv6-routing;
                level 1 disable;
                level 2 {
                    authentication-key "$9$.fQntu1ylM/ClM8XbwmfT"; ## SECRET-DATA
                    authentication-type md5;
                }
                interface ge-1/2/1.305;
                interface ge-1/2/2.103;
                interface ge-1/2/2.203;
                interface ae10.0 {
                    bfd-liveness-detection {
                        minimum-interval 300;
                    }
                }
                interface lo0.3;
            }
        }
        policy-options {
            policy-statement exp-bgp-lo0-v6 {
                term 1 {
                    from {
                        route-filter 2011:0310:1020::3/128 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-nhs {
                term 1 {
                    from {
                        protocol bgp;
                        route-type external;
                    }
                    then {
                        next-hop self;
                    }
                }
            }
            policy-statement exp-bgp-p-out {
                term 1 {
                    from {
                        protocol bgp;
                        community t-route;
                    }
                    then reject;
                }
                term 2 {
                    from {
                        route-filter 0.0.0.0/0 prefix-length-range /21-/32;
                    }
                    then reject;
                }
                term 3 {
                    from {
                        route-filter ::/0 prefix-length-range /49-/128;
                    }
                    then reject;
                }
            }
            policy-statement exp-bgp-t-out {
                term 1 {
                    from {
                        protocol bgp;
                        community p-route;
                    }
                    then reject;
                }
                term 2 {
                    then accept;
                }
            }
            policy-statement imp-bgp-p-tag {
                term 1 {
                    from protocol bgp;
                    then {
                        community add p-route;
                    }
                }
            }
            policy-statement imp-bgp-rtbh {
                term 1 {
                    from {
                        protocol bgp;
                        community rtbh;
                        route-filter 0.0.0.0/0 prefix-length-range /32-/32;
                    }
                    then {
                        next-hop discard;
                        accept;
                    }
                }
                term 2 {
                    from {
                        protocol bgp;
                        community rtbh;
                        route-filter ::/0 prefix-length-range /128-/128;
                    }
                    then {
                        next-hop discard;
                        accept;
                    }
                }
                term 3 {
                    from {
                        protocol bgp;
                        community rtbh;
                    }
                    then {
                        community delete rtbh;
                    }
                }
            }
            policy-statement imp-bgp-t-tag {
                term 1 {
                    from protocol bgp;
                    then {
                        community add t-route;
                    }
                }
            }
            policy-statement load-balance {
                then {
                    load-balance per-packet;
                }
            }
            community c-route members 65513:100;
            community p-route members 65513:200;
            community rtbh members [ 65412:100 target:4012345678L:2000 ];
            community t-route members 65513:300;
        }
        routing-options {
            graceful-restart;
            rib-groups {
                copy-inet.3-to-inet6.3 {
                    import-rib [ inet.3 inet6.3 ];
                }
            }
            autonomous-system 4012345678;
            forwarding-table {
                export load-balance;
            }
        }
        firewall {
            family any {
                filter POLICER-600M {
                    term 1 {
                        then {
                            policer POLICER-600M;
                            accept;
                        }
                    }
                }
                filter lsp-60m {
                    term 1 {
                        then {
                            policer 60m;
                            count 60m;
                        }
                    }
                }
            }
            policer POLICER-600M {
                if-exceeding {
                    bandwidth-limit 600m;
                    burst-size-limit 150k;
                }
                then discard;
            }
            policer 60m {
                if-exceeding {
                    bandwidth-limit 60m;
                    burst-size-limit 15k;
                }
                then discard;
            }
        }
    }
    r4 {
        apply-groups interface;
        interfaces {
            ge-1/2/1 {
                unit 406 {
                    vlan-id 406;
                    family inet {
                        address 100.0.46.1/24;
                    }
                }
                unit 435 {
                    description Connect-R4-C5;
                    vlan-id 435;
                    family inet6 {
                        address ::100.4.35.1/120;
                    }
                }
                unit 642 {
                    vlan-id 642;
                    family inet {
                        address 200.6.42.1/24;
                    }
                }
                unit 643 {
                    vlan-id 643;
                    family inet {
                        address 200.6.43.1/24;
                    }
                }
            }
            ge-1/2/2 {
                unit 204 {
                    vlan-id 204;
                    family inet {
                        address 100.0.24.2/24;
                    }
                }
            }
            lo0 {
                unit 4 {
                    family inet {
                        address 10.200.1.4/32;
                    }
                    family iso {
                        address 49.0000.0102.0000.1004.00;
                    }
                    family inet6 {
                        address 2011:0310:1020::4/128;
                    }
                }
                inactive: unit 12 {
                    apply-groups-except interface;
                    family inet {
                        address 4.4.4.4/32;
                    }
                }
                unit 444 {
                    apply-groups-except interface;
                    family inet {
                        address 4.4.4.4/32;
                    }
                }
            }
        }
        protocols {
            rsvp {
                interface ge-1/2/2.204;
                interface ge-1/2/1.406;
            }
            mpls {
                ipv6-tunneling;
                icmp-tunneling;
                label-switched-path r4-r1 {
                    to 10.200.1.1;
                }
                label-switched-path r4-r2 {
                    to 10.200.1.2;
                }
                label-switched-path r4-r3 {
                    to 10.200.1.3;
                    bandwidth 600m;
                    adaptive;
                    primary via-r2;
                    secondary via-r2-r5 {
                        standby;
                    }
                }
                label-switched-path r4-r5 {
                    to 10.200.1.5;
                    ldp-tunneling;
                }
                label-switched-path r4-r6 {
                    to 10.200.1.6;
                    ldp-tunneling;
                }
                path via-r2 {
                    10.200.1.2 strict;
                }
                path via-r2-r5 {
                    10.200.1.2 strict;
                    10.200.1.5 loose;
                }
                interface ge-1/2/2.204;
                interface ge-1/2/1.406;
            }
            bgp {
                group to-v4v6-rr {
                    type internal;
                    local-address 10.200.1.4;
                    family inet {
                        unicast;
                    }
                    family inet6 {
                        labeled-unicast {
                            explicit-null;
                        }
                    }
                    export [ exp-bgp-nhs exp-bgp-lo0-v6 ];
                    neighbor 10.200.1.6;
                    neighbor 10.200.1.5;
                }
                group to-c5 {
                    type external;
                    import imp-bgp-c-tag;
                    family inet6 {
                        unicast;
                    }
                    neighbor ::100.4.35.2 {
                        peer-as 500;
                    }
                }
                group to-vpn-rr {
                    type internal;
                    local-address 10.200.1.4;
                    family inet-vpn {
                        unicast;
                    }
                    neighbor 10.200.1.2;
                    neighbor 10.200.1.3;
                }
            }
            isis {
                reference-bandwidth 5g;
                no-ipv6-routing;
                level 1 disable;
                level 2 {
                    authentication-key "$9$IkWhyKX7V4aUM8aUjH5TRhS"; ## SECRET-DATA
                    authentication-type md5;
                }
                interface ge-1/2/1.406;
                interface ge-1/2/2.204;
                interface lo0.4;
            }
            ldp {
                interface lo0.4;
            }
        }
        policy-options {
            policy-statement exp-bgp-lo0-v6 {
                term 1 {
                    from {
                        route-filter 2011:0310:1020::4/128 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-nhs {
                term 1 {
                    from {
                        protocol bgp;
                        route-type external;
                    }
                    then {
                        next-hop self;
                    }
                }
            }
            policy-statement imp-bgp-c-tag {
                term 1 {
                    from protocol bgp;
                    then {
                        community add c-route;
                    }
                }
            }
            policy-statement vrf-exp {
                term 1 {
                    from protocol ospf;
                    then {
                        community add GREEN;
                        community add ce2;
                        accept;
                    }
                }
                term 2 {
                    from {
                        protocol direct;
                        route-filter 200.6.42.0/24 exact;
                    }
                    then {
                        community add GREEN;
                        community add ce2;
                        accept;
                    }
                }
                term 3 {
                    from protocol bgp;
                    then {
                        community add GREEN;
                        community add ce3;
                        accept;
                    }
                }
                term 4 {
                    from {
                        protocol direct;
                        route-filter 200.6.43.0/24 exact;
                    }
                    then {
                        community add GREEN;
                        community add ce3;
                        accept;
                    }
                }
                term 5 {
                    from {
                        protocol direct;
                        route-filter 4.4.4.4/32 exact;
                    }
                    then {
                        community add GREEN;
                        community add ce2;
                        accept;
                    }
                }
            }
            policy-statement vrf-exp-bgp-to-ospf {
                term 1 {
                    from {
                        protocol bgp;
                        community GREEN;
                    }
                    then accept;
                }
                term 2 {
                    from {
                        protocol bgp;
                        neighbor 200.6.43.2;
                    }
                    then accept;
                }
            }
            policy-statement vrf-exp-ospf-to-bgp {
                term 1 {
                    from protocol ospf;
                    then accept;
                }
                term 2 {
                    from {
                        protocol direct;
                        route-filter 200.6.42.0/24 exact;
                    }
                    then accept;
                }
            }
            policy-statement vrf-imp {
                term 1 {
                    from {
                        protocol bgp;
                        community GREEN;
                    }
                    then accept;
                }
            }
            community GREEN members target:2:65000;
            community c-route members 65513:100;
            community ce2 members target:65000:2;
            community ce3 members target:65000:3;
            community p-route members 65513:200;
            community t-route members 65513:300;
        }
        routing-instances {
            GREEN {
                instance-type vrf;
                interface ge-1/2/1.642;
                interface ge-1/2/1.643;
                interface lo0.444;
                route-distinguisher 10.200.1.4:1;
                vrf-import vrf-imp;
                vrf-export vrf-exp;
                vrf-table-label;
                protocols {
                    bgp {
                        export vrf-exp-ospf-to-bgp;
                        group to-ce3 {
                            neighbor 200.6.43.2 {
                                family inet {
                                    unicast;
                                }
                                peer-as 65000;
                                as-override;
                            }
                        }
                    }
                    ospf {
                        export vrf-exp-bgp-to-ospf;
                        sham-link local 4.4.4.4;
                        area 0.0.0.0 {
                            sham-link-remote 1.1.1.1;
                            interface ge-1/2/1.642;
                        }
                    }
                }
            }
        }
        routing-options {
            graceful-restart;
            autonomous-system 4012345678;
        }
    }
    r5 {
        apply-groups interface;
        interfaces {
            ge-1/2/1 {
                unit 506 {
                    vlan-id 506;
                    family inet {
                        address 100.0.56.1/24;
                    }
                }
                unit 507 {
                    vlan-id 507;
                    family inet {
                        address 100.0.57.1/24;
                    }
                }
                unit 512 {
                    description Connect-R5-P2;
                    vlan-id 512;
                    family inet {
                        address 100.5.12.1/24;
                    }
                    family inet6 {
                        address ::100.5.12.1/120;
                    }
                }
                unit 513 {
                    description Connect-R5-P3;
                    vlan-id 513;
                    family inet {
                        address 100.5.13.1/24;
                    }
                    family inet6 {
                        address ::100.5.13.1/120;
                    }
                }
                unit 522 {
                    vlan-id 522;
                    family inet {
                        address 100.5.22.1/24;
                    }
                    family mpls;
                }
            }
            ge-1/2/2 {
                unit 205 {
                    vlan-id 205;
                    family inet {
                        address 100.0.25.2/24;
                    }
                }
                unit 305 {
                    vlan-id 305;
                    family inet {
                        address 100.0.35.2/24;
                    }
                }
            }
            lo0 {
                unit 5 {
                    family inet {
                        address 10.200.1.5/32;
                    }
                    family iso {
                        address 49.0000.0102.0000.1005.00;
                    }
                    family inet6 {
                        address 2011:0310:1020::5/128;
                    }
                }
            }
        }
        protocols {
            rsvp {
                interface ge-1/2/2.305;
                interface ge-1/2/2.205;
                interface ge-1/2/1.506;
            }
            mpls {
                admin-groups {
                    blue 4;
                }
                ipv6-tunneling;
                icmp-tunneling;
                label-switched-path r5-r1 {
                    to 10.200.1.1;
                    ldp-tunneling;
                }
                label-switched-path r5-r2 {
                    to 10.200.1.2;
                }
                label-switched-path r5-r3 {
                    to 10.200.1.3;
                }
                label-switched-path r5-r4 {
                    to 10.200.1.4;
                    ldp-tunneling;
                }
                label-switched-path r5-r6 {
                    to 10.200.1.6;
                }
                interface ge-1/2/2.305 {
                    admin-group blue;
                }
                interface ge-1/2/2.205;
                interface ge-1/2/1.506;
                interface ge-1/2/1.507;
                interface ge-1/2/1.522;
            }
            bgp {
                group v4v6-rr {
                    type internal;
                    local-address 10.200.1.5;
                    import imp-bgp-rtbh;
                    family inet {
                        unicast;
                        labeled-unicast {
                            rib {
                                inet.3;
                            }
                        }
                    }
                    family inet6 {
                        labeled-unicast {
                            explicit-null;
                        }
                    }
                    export [ exp-bgp-nhs exp-bgp-adv-2378 exp-bgp-nh-to-r1 exp-bgp-lo0-v6 ];
                    cluster 5.5.5.5;
                    neighbor 10.200.1.1;
                    neighbor 10.200.1.2;
                    neighbor 10.200.1.3;
                    neighbor 10.200.1.4;
                    neighbor 10.200.1.7;
                    neighbor 10.200.1.8;
                }
                group to-r6 {
                    type internal;
                    local-address 10.200.1.5;
                    import imp-bgp-rtbh;
                    family inet {
                        unicast;
                        labeled-unicast {
                            rib {
                                inet.3;
                            }
                        }
                    }
                    family inet6 {
                        labeled-unicast {
                            explicit-null;
                        }
                    }
                    export [ exp-bgp-nh-to-r1 exp-bgp-lo0-v6 ];
                    neighbor 10.200.1.6;
                }
                group to-p-v4 {
                    type external;
                    import imp-bgp-p-tag;
                    family inet {
                        unicast;
                    }
                    export exp-bgp-p-out;
                    neighbor 100.5.12.2 {
                        peer-as 2000;
                    }
                    neighbor 100.5.13.2 {
                        peer-as 3000;
                    }
                }
                group to-p-v6 {
                    type external;
                    import imp-bgp-p-tag;
                    family inet6 {
                        unicast;
                    }
                    export exp-bgp-p-out;
                    neighbor ::100.5.12.2 {
                        peer-as 2000;
                    }
                    neighbor ::100.5.13.2 {
                        peer-as 3000;
                    }
                }
            }
            isis {
                reference-bandwidth 5g;
                no-ipv6-routing;
                level 1 disable;
                level 2 {
                    authentication-key "$9$8y.x-woJDmfzYgfz36u0LxN"; ## SECRET-DATA
                    authentication-type md5;
                }
                interface ge-1/2/1.506;
                interface ge-1/2/1.507;
                interface ge-1/2/2.205;
                interface ge-1/2/2.305;
                interface lo0.5;
            }
            ldp {
                interface ge-1/2/1.506;
                interface ge-1/2/1.507;
                interface lo0.5;
            }
        }
        policy-options {
            policy-statement exp-adv-pe-loop {
                term 1 {
                    from {
                        route-filter 10.200.1.1/32 exact;
                    }
                    then accept;
                }
                term 2 {
                    from {
                        rib inet.3;
                        route-filter 10.200.1.1/32 exact;
                    }
                    then accept;
                }
                term 3 {
                    then reject;
                }
            }
            policy-statement exp-bgp-adv-2378 {
                term 1 {
                    from {
                        route-filter 10.200.1.2/32 exact;
                        route-filter 10.200.1.3/32 exact;
                        route-filter 10.200.1.7/32 exact;
                        route-filter 10.200.1.8/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-lo0-v6 {
                term 1 {
                    from {
                        route-filter 10.200.0.0/16 exact;
                    }
                    then accept;
                }
                term 2 {
                    from {
                        route-filter 2011:0310::/32 exact;
                    }
                    then accept;
                }
                term 3 {
                    from {
                        route-filter 2011:0310:1020::5/128 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-nh-to-r1 {
                term 1 {
                    from {
                        protocol bgp;
                        community rtbh;
                        route-filter 0.0.0.0/0 prefix-length-range /32-/32;
                    }
                    then {
                        next-hop 10.200.1.1;
                    }
                }
                term 2 {
                    from {
                        protocol bgp;
                        community rtbh;
                        route-filter ::/0 prefix-length-range /128-/128;
                    }
                    then {
                        next-hop ::ffff:10.200.1.1;
                    }
                }
            }
            policy-statement exp-bgp-nhs {
                term 1 {
                    from {
                        protocol bgp;
                        route-type external;
                    }
                    then {
                        next-hop self;
                    }
                }
            }
            policy-statement exp-bgp-p-out {
                term 1 {
                    from {
                        protocol bgp;
                        community t-route;
                    }
                    then reject;
                }
                term 2 {
                    from {
                        route-filter 0.0.0.0/0 prefix-length-range /21-/32;
                    }
                    then reject;
                }
                term 3 {
                    from {
                        route-filter ::/0 prefix-length-range /49-/128;
                    }
                    then reject;
                }
                term 4 {
                    from {
                        protocol aggregate;
                        route-filter 10.200.0.0/16 exact;
                    }
                    then accept;
                }
                term 5 {
                    from {
                        protocol aggregate;
                        route-filter 2011:310::/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-t-out {
                term 1 {
                    from {
                        protocol bgp;
                        community p-route;
                    }
                    then reject;
                }
                term 2 {
                    then accept;
                }
            }
            policy-statement imp-bgp-p-tag {
                term 1 {
                    from protocol bgp;
                    then {
                        community add p-route;
                    }
                }
            }
            policy-statement imp-bgp-rtbh {
                term 1 {
                    from {
                        protocol bgp;
                        community rtbh;
                        route-filter 0.0.0.0/0 prefix-length-range /32-/32;
                    }
                    then {
                        next-hop discard;
                        accept;
                    }
                }
                term 2 {
                    from {
                        protocol bgp;
                        community rtbh;
                        route-filter ::/0 prefix-length-range /128-/128;
                    }
                    then {
                        next-hop discard;
                        accept;
                    }
                }
                term 3 {
                    from {
                        protocol bgp;
                        community rtbh;
                    }
                    then {
                        community delete rtbh;
                    }
                }
            }
            community c-route members 65513:100;
            community p-route members 65513:200;
            community rtbh members [ 65412:100 target:4012345678L:2000 ];
            community t-route members 65513:300;
        }
        routing-options {
            graceful-restart;
            rib inet6.0 {
                aggregate {
                    route 2011:0310::/32;
                }
            }
            aggregate {
                route 10.200.0.0/16;
            }
            autonomous-system 4012345678;
        }
    }
    r6 {
        apply-groups interface;
        interfaces {
            ge-1/2/1 {
                unit 608 {
                    vlan-id 608;
                    family inet {
                        address 100.0.68.1/24;
                    }
                }
            }
            ge-1/2/2 {
                unit 206 {
                    vlan-id 206;
                    family inet {
                        address 100.0.26.2/24;
                    }
                }
                inactive: unit 306 {
                    vlan-id 306;
                    family inet {
                        address 100.0.36.2/24;
                    }
                }
                unit 406 {
                    vlan-id 406;
                    family inet {
                        address 100.0.46.2/24;
                    }
                }
                unit 506 {
                    vlan-id 506;
                    family inet {
                        address 100.0.56.2/24;
                    }
                }
            }
            ae11 {
                unit 0 {
                    family inet {
                        address 10.100.36.2/24;
                    }
                    family iso;
                }
            }
            lo0 {
                unit 6 {
                    family inet {
                        address 10.200.1.6/32;
                    }
                    family iso {
                        address 49.0000.0102.0000.1006.00;
                    }
                    family inet6 {
                        address 2011:0310:1020::6/128;
                    }
                }
            }
        }
        protocols {
            rsvp {
                interface ge-1/2/2.206;
                interface ge-1/2/2.306;
                interface ge-1/2/2.406;
                interface ge-1/2/2.506;
            }
            mpls {
                ipv6-tunneling;
                icmp-tunneling;
                label-switched-path r6-r1 {
                    to 10.200.1.1;
                    ldp-tunneling;
                }
                label-switched-path r6-r2 {
                    to 10.200.1.2;
                }
                label-switched-path r6-r3 {
                    to 10.200.1.3;
                }
                label-switched-path r6-r4 {
                    to 10.200.1.4;
                    ldp-tunneling;
                }
                label-switched-path r6-r5 {
                    to 10.200.1.5;
                }
                interface ge-1/2/2.506;
                interface ge-1/2/2.306;
                interface ge-1/2/2.206;
                interface ge-1/2/2.406;
                interface ge-1/2/1.608;
            }
            bgp {
                group v4v6-rr {
                    type internal;
                    local-address 10.200.1.6;
                    family inet {
                        unicast;
                        labeled-unicast {
                            rib {
                                inet.3;
                            }
                        }
                    }
                    family inet6 {
                        labeled-unicast {
                            explicit-null;
                        }
                    }
                    export [ exp-bgp-nhs exp-bgp-adv-2378 exp-bgp-lo0-v6 ];
                    cluster 6.6.6.6;
                    neighbor 10.200.1.1;
                    neighbor 10.200.1.2;
                    neighbor 10.200.1.3;
                    neighbor 10.200.1.4;
                    neighbor 10.200.1.8;
                    neighbor 10.200.1.7;
                }
                group to-r5 {
                    type internal;
                    local-address 10.200.1.6;
                    family inet {
                        unicast;
                        labeled-unicast {
                            rib {
                                inet.3;
                            }
                        }
                    }
                    family inet6 {
                        labeled-unicast {
                            explicit-null;
                        }
                    }
                    export exp-bgp-lo0-v6;
                    neighbor 10.200.1.5;
                }
            }
            isis {
                reference-bandwidth 5g;
                no-ipv6-routing;
                level 1 disable;
                level 2 {
                    authentication-key "$9$x6d-b2ZUH5Qn4aQn/CB17-V"; ## SECRET-DATA
                    authentication-type md5;
                }
                interface ge-1/2/1.608;
                interface ge-1/2/2.206;
                interface ge-1/2/2.406;
                interface ge-1/2/2.506;
                interface ae11.0 {
                    bfd-liveness-detection {
                        minimum-interval 300;
                    }
                }
                interface lo0.6;
            }
            ldp {
                interface ge-1/2/1.608;
                interface ge-1/2/2.506;
                interface lo0.6;
            }
        }
        policy-options {
            policy-statement exp-bgp-adv-2378 {
                term 1 {
                    from {
                        route-filter 10.200.1.2/32 exact;
                        route-filter 10.200.1.3/32 exact;
                        route-filter 10.200.1.7/32 exact;
                        route-filter 10.200.1.8/32 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-lo0-v6 {
                term 1 {
                    from {
                        route-filter 10.200.0.0/16 exact;
                    }
                    then accept;
                }
                term 2 {
                    from {
                        route-filter 2011:0310::/32 exact;
                    }
                    then accept;
                }
                term 3 {
                    from {
                        route-filter 2011:0310:1020::6/128 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-nhs {
                term 1 {
                    from {
                        protocol bgp;
                        route-type external;
                    }
                    then {
                        next-hop self;
                    }
                }
            }
        }
        routing-options {
            graceful-restart;
            rib inet6.0 {
                aggregate {
                    route 2011:310::/32;
                }
            }
            aggregate {
                route 10.200.0.0/16;
            }
            autonomous-system 4012345678;
        }
    }
    r7 {
        apply-groups interface;
        interfaces {
            ge-1/2/1 {
                unit 708 {
                    vlan-id 708;
                    family inet {
                        address 100.0.78.1/24;
                    }
                }
                unit 734 {
                    description Connect-R7-C4;
                    vlan-id 734;
                    family inet {
                        address 100.7.34.1/24;
                    }
                    family inet6 {
                        address ::100.7.34.1/120;
                    }
                }
            }
            ge-1/2/2 {
                unit 507 {
                    vlan-id 507;
                    family inet {
                        address 100.0.57.2/24;
                    }
                }
            }
            lo0 {
                unit 7 {
                    family inet {
                        address 10.200.1.7/24;
                    }
                    family iso {
                        address 49.0000.0102.0000.1007.00;
                    }
                    family inet6 {
                        address 2011:0310:1020::7/128;
                    }
                }
            }
        }
        protocols {
            mpls {
                ipv6-tunneling;
                icmp-tunneling;
                interface ge-1/2/1.708;
                interface ge-1/2/2.507;
            }
            bgp {
                group to-v4v6-rr {
                    type internal;
                    local-address 10.200.1.7;
                    family inet {
                        unicast;
                        labeled-unicast {
                            rib-group copy-inet.3-to-inet6.3;
                            rib {
                                inet.3;
                            }
                        }
                    }
                    family inet6 {
                        labeled-unicast {
                            explicit-null;
                        }
                    }
                    export [ exp-bgp-nhs exp-bgp-lo0-v6 ];
                    neighbor 10.200.1.5;
                    neighbor 10.200.1.6;
                }
                group to-vpn-rr {
                    type internal;
                    local-address 10.200.1.7;
                    family inet-vpn {
                        unicast;
                    }
                    family l2vpn {
                        signaling;
                    }
                    neighbor 10.200.1.2;
                    neighbor 10.200.1.3;
                }
                group to-c4 {
                    type external;
                    accept-remote-nexthop;
                    import [ imp-bgp-c-tag imp-bgp-fix-nh ];
                    family inet {
                        unicast;
                    }
                    family inet6 {
                        unicast;
                    }
                    export exp-bgp-fix-nh;
                    neighbor 100.7.34.2 {
                        peer-as 400;
                    }
                }
            }
            isis {
                reference-bandwidth 5g;
                no-ipv6-routing;
                level 1 disable;
                level 2 {
                    authentication-key "$9$DmH.5n/tIEyQFEylKx7jHq"; ## SECRET-DATA
                    authentication-type md5;
                }
                interface ge-1/2/1.708;
                interface ge-1/2/2.507;
                interface lo0.7;
            }
            ldp {
                interface ge-1/2/1.708;
                interface ge-1/2/2.507;
                interface lo0.7;
            }
        }
        policy-options {
            policy-statement exp-bgp-fix-nh {
                term 1 {
                    from {
                        protocol bgp;
                        route-filter ::/0 prefix-length-range /0-/128;
                    }
                    then {
                        next-hop ::100.7.34.1;
                    }
                }
            }
            policy-statement exp-bgp-lo0-v6 {
                term 1 {
                    from {
                        route-filter 2011:0310:1020::7/128 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-nhs {
                term 1 {
                    from {
                        protocol bgp;
                        route-type external;
                    }
                    then {
                        next-hop self;
                    }
                }
            }
            policy-statement imp-bgp-c-tag {
                term 1 {
                    from protocol bgp;
                    then {
                        community add c-route;
                    }
                }
            }
            policy-statement imp-bgp-fix-nh {
                term 1 {
                    from {
                        protocol bgp;
                        route-filter ::/0 prefix-length-range /0-/128;
                    }
                    then {
                        next-hop ::100.7.34.2;
                    }
                }
            }
            community c-route members 65513:100;
            community p-route members 65513:200;
            community t-route members 65513:300;
        }
        routing-options {
            graceful-restart;
            rib-groups {
                copy-inet.3-to-inet6.3 {
                    import-rib [ inet.3 inet6.3 ];
                }
            }
            autonomous-system 4012345678;
        }
    }
    r8 {
        apply-groups interface;
        interfaces {
            ge-1/2/1 {
                unit 684 {
                    apply-groups-except interface;
                    vlan-id 684;
                    family inet {
                        address 200.6.84.1/24;
                    }
                }
                unit 685 {
                    apply-groups-except interface;
                    vlan-id 685;
                    family inet {
                        address 200.6.85.1/24;
                    }
                }
            }
            ge-1/2/2 {
                unit 608 {
                    vlan-id 608;
                    family inet {
                        address 100.0.68.2/24;
                    }
                }
                unit 708 {
                    vlan-id 708;
                    family inet {
                        address 100.0.78.2/24;
                    }
                }
            }
            lo0 {
                unit 8 {
                    family inet {
                        address 10.200.1.8/32;
                    }
                    family iso {
                        address 49.0000.0102.0000.1008.00;
                    }
                    family inet6 {
                        address 2011:0310:1020::8/128;
                    }
                }
                unit 888 {
                    family inet {
                        address 8.8.8.8/32;
                    }
                }
            }
        }
        protocols {
            mpls {
                ipv6-tunneling;
                icmp-tunneling;
                interface ge-1/2/2.608;
                interface ge-1/2/2.708;
            }
            bgp {
                group to-v4v6-rr {
                    type internal;
                    local-address 10.200.1.8;
                    family inet {
                        unicast;
                        labeled-unicast {
                            rib-group copy-inet.3-to-inet6.3;
                            rib {
                                inet.3;
                            }
                        }
                    }
                    family inet6 {
                        labeled-unicast {
                            explicit-null;
                        }
                    }
                    export [ exp-bgp-nhs exp-bgp-lo0-v6 ];
                    neighbor 10.200.1.5;
                    neighbor 10.200.1.6;
                }
                group to-vpn-rr {
                    type internal;
                    local-address 10.200.1.8;
                    family inet-vpn {
                        unicast;
                    }
                    neighbor 10.200.1.3;
                    neighbor 10.200.1.2;
                }
            }
            isis {
                reference-bandwidth 5g;
                no-ipv6-routing;
                level 1 disable;
                level 2 {
                    authentication-key "$9$-2bYoDi.z39JG39ApREdbs"; ## SECRET-DATA
                    authentication-type md5;
                }
                interface ge-1/2/2.608;
                interface ge-1/2/2.708;
                interface lo0.8;
            }
            ldp {
                interface ge-1/2/2.608;
                interface ge-1/2/2.708;
                interface lo0.8;
            }
        }
        policy-options {
            policy-statement exp-bgp-lo0-v6 {
                term 1 {
                    from {
                        route-filter 2011:0310:1020::8/128 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-bgp-nhs {
                term 1 {
                    from {
                        protocol bgp;
                        route-type external;
                    }
                    then {
                        next-hop self;
                    }
                }
            }
            policy-statement exp-direct-ce4-to-ce5 {
                term 1 {
                    from {
                        protocol direct;
                        route-filter 200.6.84.0/24 exact;
                    }
                    then accept;
                }
            }
            policy-statement exp-direct-ce5-to-ce4 {
                term 1 {
                    from {
                        protocol direct;
                        route-filter 200.6.85.0/24 exact;
                    }
                    then accept;
                }
            }
            policy-statement vrf-exp {
                term 1 {
                    from protocol bgp;
                    then {
                        community add GREEN;
                        accept;
                    }
                }
                term 2 {
                    from protocol direct;
                    then {
                        community add GREEN;
                        accept;
                    }
                }
            }
            policy-statement vrf-imp {
                term 1 {
                    from {
                        protocol bgp;
                        community GREEN;
                    }
                    then accept;
                }
            }
            community GREEN members target:2:65000;
        }
        routing-instances {
            GREEN {
                instance-type vrf;
                interface ge-1/2/1.684;
                interface ge-1/2/1.685;
                interface lo0.888;
                route-distinguisher 10.200.1.8:1;
                vrf-import vrf-imp;
                vrf-export vrf-exp;
                vrf-table-label;
                protocols {
                    bgp {
                        group to-ce4-ce5 {
                            type external;
                            family inet {
                                unicast;
                            }
                            peer-as 65000;
                            as-override;
                            neighbor 200.6.84.2 {
                                export exp-direct-ce5-to-ce4;
                            }
                            neighbor 200.6.85.2 {
                                export exp-direct-ce4-to-ce5;
                            }
                        }
                    }
                }
            }
        }
        routing-options {
            graceful-restart;
            rib-groups {
                copy-inet.3-to-inet6.3 {
                    import-rib [ inet.3 inet6.3 ];
                }
            }
            autonomous-system 4012345678;
        }
    }
}
